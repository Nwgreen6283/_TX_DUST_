---
title: "vp daily"
format:
  html:
    theme: default
---

# LIBS/DATA

#### LIBRARIES

```{r}
library(here)
library(tidyverse)
library(lubridate)
library(ggpubr) #Stacking Plots
```

#### DATA

```{r, include=FALSE}
master<- read_csv(here("data", "processed_data","tx_master.csv"))
```

#### 

# DAILY PLOTS

## Vp

```{r}
#png(file = here("results", "plots", "species_specific", "vp_daily.png"))
 master %>%
   filter(Type %in% "Daily") %>%
  ggplot() + geom_line(
    aes(x = date,
        y = Vp,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Daily Vibrio parahaemolyticus",
       caption = "BO was 1:10")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))
# dev.off()

 ggsave(here("results", "plots", "vp_daily.png"))
```

## Vv

```{r}
#png(file = here("results", "plots", "species_specific", "vv_daily.png"))

 master %>%
   filter(Type %in% "Daily") %>%
  ggplot() + geom_line(
    aes(x = date,
        y = Vv,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Daily Vibrio vulnificus")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+ 
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))
#dev.off()

 ggsave(here("results", "plots", "vv_daily.png"))
```

## Vc

For Vc, we ran it initial with all three sites. Then tested BO for INH, and it looked inhibited. So we ran 1:50 (still inh), 1:100 (too dilute), and 1:50 one more time. For the 1:50 trials we had a total of 5 reps (which is what we see below for BO). We have the data (raw/processed) for the other trials, but they have been removed here so as to clear up space.

```{r}
 master %>%
   filter(Type %in% "Daily") %>%
  ggplot() + geom_line(
    aes(x = date,
        y = Vc,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Daily Vibrio cholerae ",
       caption = "Blind Oso was 1:50")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+ 
  scale_color_manual(values = c("Blind Oso" = "#809C52", #5 replicates
                                "Canals" = "#ba4716",#3
                                "Gulf" = "4c848c"))#3

 ggsave(here("results", "plots", "vc_daily.png"))
```

#### 

## Va

<!--# Melt curves inidicated multiple targets amplified. So ignore Va for now. Will troubleshoot other assays -->

```{r}
#png(file = here("results", "plots", "species_specific", "va_daily.png"))

#va %>%
 #filter(!site %in% "Blind Oso") %>%
  #ggplot() + geom_line(
  #  aes(x = date,
      #  y = copies_mL,
        #color = site))+ 
  #facet_wrap(~site)  +
 # labs(x = "Date",
      # title = "Daily Vibrio alginolyticus",
       #caption = "gyrB. Will Re-do with groEL")+
  #theme_bw()+
  #theme(
    #plot.title = element_text(hjust = 0.5),
    #axis.text.x = element_text(hjust = 1, angle = 45),
    #legend.position = "none")+ 
 # scale_color_manual(values = c("Blind Oso" = "#809C52",
                               # "Canals" = "#ba4716",
                                #"Gulf" = "4c848c"))
#dev.off()

 #ggsave(here("results", "plots", "va_daily.png"))
```

## Combine all species

#### Combine dataset

#### Plot

##### Blind Oso

```{r}
bo_spp<- 
  master %>%
  filter(Type %in% "Daily",
         site %in% "Blind Oso") %>%
  ggplot() +
  geom_line(
    aes(
      x = date,
      y = Vc),
      color = "#00BFC4",
    size = 1)+ 
  geom_line(
    aes(
      x = date,
      y = Vv),
      color = "#00BA38",
    size = 1)+ 
    geom_line(
    aes(
      x = date,
      y = Vp),
      color = "#C77CFF",
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Blind Oso",
       x = "Date",
       y = "Vibrio gene copies/mL") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") 

bo_spp

#dev.off()
 ggsave(here("results", "plots", "bo_all_daily.png"))
```

##### Canals

```{r}
c2_spp<-
  master %>%
  filter(Type %in% "Daily",
         site %in% "Canals") %>%
  ggplot() +
  geom_line(
    aes(
      x = date,
      y = Vc),
      color = "#00BFC4",
    size = 1)+ 
  geom_line(
    aes(
      x = date,
      y = Vv),
      color = "#00BA38",
    size = 1)+ 
    geom_line(
    aes(
      x = date,
      y = Vp),
      color = "#C77CFF",
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Canals",
       x = "Date",
       y = "Vibrio gene copies/mL") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") 

c2_spp

 ggsave(here("results", "plots", "c2_all_daily.png"))
```

##### Gulf

```{r}
rd_spp<-
  master %>%
  filter(Type %in% "Daily",
         site %in% "Gulf") %>%
  ggplot() +
  geom_line(
    aes(
      x = date,
      y = Vc),
      color = "#00BFC4",
    size = 1)+ 
  geom_line(
    aes(
      x = date,
      y = Vv),
      color = "#00BA38",
    size = 1)+ 
    geom_line(
    aes(
      x = date,
      y = Vp),
      color = "#C77CFF",
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Gulf",
       x = "Date",
       y = "Vibrio gene copies/mL") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") 

rd_spp

 ggsave(here("results", "plots", "rd_all_daily.png"))
```

#### Combine

```{r, fig.width= 4}
all_spp<-
  ggarrange(bo_spp, c2_spp, rd_spp,
            nrow = 1,
            ncol = 3)
all_spp
```

# MONTHLY PLOTS

#### Vp

```{r}
#png(file = here("results", "plots", "species_specific", "vp_mon.png"))

  master %>%
  filter(Type %in% "Monthly") %>%
  ggplot() +
    geom_line(
    aes(
      x = date,
      y = Vp,
      color = site),
    size = 1)+ 
  theme_bw()+
     labs(title = "Vp",
       x = "Date",
       y = "Vibrio gene copies/mL") +
    facet_wrap(~site) +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") +
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")

#dev.off()

 ggsave(here("results", "plots", "vp_monthly.png"))
```

#### Vv

```{r}
#png(file = here("results", "plots", "species_specific", "vv_mon.png"))
  master %>%
  filter(Type %in% "Monthly") %>%
  ggplot() +
    geom_line(
    aes(
      x = date,
      y = Vv,
      color = site),
    size = 1)+ 
  theme_bw()+
     labs(title = "Vv",
       x = "Date",
       y = "Vibrio gene copies/mL") +
    facet_wrap(~site) +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") +
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")
#dev.off()

  ggsave(here("results", "plots", "vv_monthly.png"))
```

#### Vc

```{r}
#png(file = here("results", "plots", "species_specific", "vc_mon.png"))
  master %>%
  filter(Type %in% "Monthly") %>%
  ggplot() +
    geom_line(
    aes(
      x = date,
      y = Vc,
      color = site),
    size = 1)+ 
  theme_bw()+
     labs(title = "Vc",
       x = "Date",
       y = "Vibrio gene copies/mL") +
    facet_wrap(~site) +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") +
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")
#dev.off()

 ggsave(here("results", "plots", "vc_monthly.png"))
 
```

#### Plot

##### Blind Oso

```{r}
bo_spp_monthly<-
  master %>%
  filter(Type %in% "Monthly",
         site %in% "Blind Oso") %>%
  ggplot() +
  geom_line(
    aes(
      x = date,
      y = Vc),
      color = "#00BFC4",
    size = 1)+ 
  geom_line(
    aes(
      x = date,
      y = Vv),
      color = "#00BA38",
    size = 1)+ 
    geom_line(
    aes(
      x = date,
      y = Vp),
      color = "#C77CFF",
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Blind Oso",
       x = "Date",
       y = "Vibrio gene copies/mL") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") 

bo_spp_monthly

#dev.off()
 ggsave(here("results", "plots", "bo_all_monthly.png"))
```

##### Canals

```{r}
c2_spp_monthly<-
  master %>%
  filter(Type %in% "Monthly",
         site %in% "Canals") %>%
  ggplot() +
  geom_line(
    aes(
      x = date,
      y = Vc),
      color = "#00BFC4",
    size = 1)+ 
  geom_line(
    aes(
      x = date,
      y = Vv),
      color = "#00BA38",
    size = 1)+ 
    geom_line(
    aes(
      x = date,
      y = Vp),
      color = "#C77CFF",
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Canals",
       x = "Date",
       y = "Vibrio gene copies/mL") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") 

c2_spp_monthly

#dev.off()
 ggsave(here("results", "plots", "c2_all_monthly.png"))
```

##### Gulf

```{r}
rd_spp_monthly<- 
  master %>%
  filter(Type %in% "Monthly",
         site %in% "Gulf") %>%
  ggplot() +
  geom_line(
    aes(
      x = date,
      y = Vc),
      color = "#00BFC4",
    size = 1)+ 
  geom_line(
    aes(
      x = date,
      y = Vv),
      color = "#00BA38",
    size = 1)+ 
    geom_line(
    aes(
      x = date,
      y = Vp),
      color = "#C77CFF",
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Gulf",
       x = "Date",
       y = "Vibrio gene copies/mL") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") 

rd_spp_monthly

#dev.off()
 ggsave(here("results", "plots", "rd_all_monthly.png"))
```
