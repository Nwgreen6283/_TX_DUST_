---
title: "vp daily"
format:
  html:
    theme: default
---

# LIBS/DATA

#### LIBRARIES

```{r}
library(here)
library(tidyverse)
library(lubridate)
library(ggpubr) #Stacking Plots
```

#### DATA

```{r, include=FALSE}
vp<- read_csv(here("data", "processed_data","qpcr", "vp_clean_copies.csv"))
vp_m<- read_csv(here("data", "processed_data","qpcr","vp_mon_clean_copies.csv")) 

vv<- read_csv(here("data", "processed_data","qpcr","vv_clean_copies_redo.csv")) #Trial two is best. Other trials exist too. 
vv_m<- read_csv(here("data", "processed_data","qpcr","vv_clean_copies_mon.csv"))

vc<- read_csv(here("data", "processed_data","qpcr", "vc_clean_copies_daily.csv")) #Daily
vc_m<- read_csv(here("data", "processed_data", "qpcr","vc_clean_copies_mon.csv"))#Monthly
vc_bo<- read_csv(here("data", "processed_data","qpcr","vc_clean_copies_dail_1_50.csv")) #Ran 1:50. with 5 reps (run with 2 reps + run with 3 reps)
#vc_bo_50<- read_csv(here("data", "processed_data","vc_clean_copies_daily_1_50_2reps.csv"))#Just reps 4 and 5 to compare. This looks fine, but I removed the code so as to clean up this script.

va<- read_csv(here("data", "processed_data","qpcr", "va_clean_copies_daily.csv"))
va_m<-  read_csv(here("data", "processed_data","qpcr", "va_clean_copies_monthly.csv"))
```

# CLEANING

#### Clean Daily data sets

```{r}
vv<- vv %>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))

vp<- vp %>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))

vc<- vc %>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))
vc_bo<- vc_bo %>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))
#vc_bo_50<- vc_bo_50 %>%
 # mutate(site = recode(site, "BO" = "Blind Oso")) %>%
 # mutate(site = recode(site, "C2" = "Canals")) %>%
 # mutate(site = recode(site, "RD" = "Gulf"))

va<- va %>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))
```

#### Combine 5 rep Vc BO Daily to Canals and Gulf

```{r}
vc<- 
  vc %>%
  filter(!site %in% "Blind Oso")  #Gets rid of old BO 
  
vc_d<- rbind(vc, vc_bo) #Adds new BO to C2 and RD
```

#### Add July to Monthly Data

```{r}
#Vp Mon
vp_m<- vp_m %>%
  select(!...1) 
jul_bo = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "BO")
jul_c2 = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "C2")
jul_rd = data.frame(date = as.Date("2022-07-07"), copies_mL=7.49310194, site = "RD")
vp_m = rbind(jul_bo, jul_c2, jul_rd, vp_m) %>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))
                     

#Vv Mon
vv_m<- vv_m %>%
  select(!...1) 
jul_bo = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "BO")
jul_c2 = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "C2")
jul_rd = data.frame(date = as.Date("2022-07-07"), copies_mL=7.49310194, site = "RD")
vv_m = rbind(jul_bo, jul_c2, jul_rd, vv_m)%>%
  mutate(site = recode(site, "BO" = "Blind Oso")) %>%
  mutate(site = recode(site, "C2" = "Canals")) %>%
  mutate(site = recode(site, "RD" = "Gulf"))

vc_m<- vc_m %>%
  select(!...1) 
  jul_bo = data.frame(date = as.Date("2022-07-07"), copies_mL=263.208407, site = "BO")
  jul_c2 = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "C2")
  jul_rd = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "RD")
  vc_m = rbind(jul_bo, jul_c2, jul_rd, vc_m)%>%
    mutate(site = recode(site, "BO" = "Blind Oso")) %>%
    mutate(site = recode(site, "C2" = "Canals")) %>%
    mutate(site = recode(site, "RD" = "Gulf"))
  
 va_m<- va_m %>%
  select(!...1) 
  jul_bo = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "BO")
  jul_c2 = data.frame(date = as.Date("2022-07-07"), copies_mL=5.494766, site = "C2")
  jul_rd = data.frame(date = as.Date("2022-07-07"), copies_mL=0, site = "RD")
  va_m = rbind(jul_bo, jul_c2, jul_rd, va_m)%>%
    mutate(site = recode(site, "BO" = "Blind Oso")) %>%
    mutate(site = recode(site, "C2" = "Canals")) %>%
    mutate(site = recode(site, "RD" = "Gulf")) 
```

# DAILY PLOTS

## Vp

```{r}
#png(file = here("results", "plots", "species_specific", "vp_daily.png"))
 vp %>%
  ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Daily Vibrio parahaemolyticus",
       caption = "BO was 1:10")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))
# dev.off()

 ggsave(here("results", "plots", "vp_daily.png"))
```

## Vv

```{r}
#png(file = here("results", "plots", "species_specific", "vv_daily.png"))

vv %>%
  #filter(!site %in% "Blind Oso") %>%
  ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Daily Vibrio vulnificus")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+ 
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))
#dev.off()

 ggsave(here("results", "plots", "vv_daily.png"))
```

## Vc

For Vc, we ran it initial with all three sites. Then tested BO for INH, and it looked inhibited. So we ran 1:50 (still inh), 1:100 (too dilute), and 1:50 one more time. For the 1:50 trials we had a total of 5 reps (which is what we see below for BO). We have the data (raw/processed) for the other trials, but they have been removed here so as to clear up space.

```{r}
vc_d %>%
#filter(!site %in% "Blind Oso") %>%
  ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Vc at Blind Oso ",
       caption = "Blind Oso was 1:50")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+ 
  scale_color_manual(values = c("Blind Oso" = "#809C52", #5 replicates
                                "Canals" = "#ba4716",#3
                                "Gulf" = "4c848c"))#3

 ggsave(here("results", "plots", "vc_daily.png"))
```

#### 

## Va

```{r}
#png(file = here("results", "plots", "species_specific", "va_daily.png"))

va %>%
 #filter(!site %in% "Blind Oso") %>%
  ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Daily Vibrio alginolyticus",
       caption = "gyrB. Will Re-do with groEL")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+ 
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))
#dev.off()

 ggsave(here("results", "plots", "va_daily.png"))
```

## Combine all species

#### Combine dataset

```{r}
#Make new columns with species 
type = "vc"
vc1<- cbind(vc_d, type)

type = "vv"
vv1<- cbind(vv, type)

type = "vp"
vp1<- cbind(vp, type)

type = "va"
va1<- cbind(va,type)

#Combine datasets
master<- rbind(vc1,vp1,vv1, va1) %>%
  mutate(type = recode(type, "va" = "V. alginolyticus",
                       "vc" = "V. cholerae",
                       "vp" = "V. parahaemolyticus",
                       "vv" = "V. vulnificus"))
# Save this
saveRDS(master, file = here("data", "processed_data","species_copies.rds"))
```

#### Plot

##### Blind Oso

```{r}
bo_spp<- master %>%
  filter(site %in% "Blind Oso") %>%
  filter(!type %in% "V. cholerae") %>%
  ggplot() + geom_line(
    aes(
      x = date,
      y = copies_mL,
      color = type),
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at Blind Oso",
       x = "Date",
       y = "Copies/mL",
       color = "Vibrio spp.") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") + 
scale_color_manual(values = c("V. alginolyticus" = "#F8766D",
                              "V. cholerae" = "#00BFC4",
                              "V. parahaemolyticus" = "#C77CFF",
                              "V. vulnificus" = "#00BA38"))

bo_spp

#dev.off()
 ggsave(here("results", "plots", "bo_all_daily.png"))
```

##### Canals

```{r}
c2_spp<-
  master %>%
  filter(site %in% "Canals") %>%
  #filter(!type %in% "V. cholerae") %>%
  ggplot() + geom_line(
    aes(
      x = date,
      y = copies_mL,
      color = type),
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at the Canals",
       x = "Date",
       y = "Copies/mL",
       color = "Vibrio spp.") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") + 
scale_color_manual(values = c("V. alginolyticus" = "#F8766D",
                              "V. cholerae" = "#00BFC4",
                              "V. parahaemolyticus" = "#C77CFF",
                              "V. vulnificus" = "#00BA38"))

c2_spp

 ggsave(here("results", "plots", "c2_all_daily.png"))
```

##### Gulf

```{r}
rd_spp<-
 master %>%
  filter(site %in% "Gulf") %>%
  #filter(!type %in% "V. cholerae") %>%
  ggplot() + geom_line(
    aes(
      x = date,
      y = copies_mL,
      color = type),
    size = 1)+ 
  theme_bw()+
     labs(title = "Vibrio Species at the Gulf",
       x = "Date",
       y = "Copies/mL",
       color = "Vibrio spp.") +
  theme(axis.text.x = element_text(hjust = 1, angle = 45),
        plot.title = element_text(hjust = 0.5),
        legend.position = "none") + 
scale_color_manual(values = c("V. alginolyticus" = "#F8766D",
                              "V. cholerae" = "#00BFC4",
                              "V. parahaemolyticus" = "#C77CFF",
                              "V. vulnificus" = "#00BA38"))

rd_spp

 ggsave(here("results", "plots", "rd_all_daily.png"))
```

#### Combine

```{r, fig.width= 4}
all_spp<-
  ggarrange(bo_spp, c2_spp, rd_spp,
            nrow = 1,
            ncol = 3)
all_spp
```

# MONTHLY PLOTS

#### Vp

```{r}
#png(file = here("results", "plots", "species_specific", "vp_mon.png"))

vp_m %>%
ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  geom_point(
     aes(x = date,
        y = copies_mL,
        color = site))+
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Monthly Vibrio parahaemolyticus")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")

#dev.off()

 ggsave(here("results", "plots", "vp_monthly.png"))
```

#### Vv

```{r}
#png(file = here("results", "plots", "species_specific", "vv_mon.png"))
 vv_m %>%
  filter(!site %in% c("E3", "NT")) %>%
 ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  geom_point(
     aes(x = date,
        y = copies_mL,
        color = site))+
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Monthly Vibrio vulnificus")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")
#dev.off()

  ggsave(here("results", "plots", "vv_monthly.png"))
```

#### Vc

```{r}
#png(file = here("results", "plots", "species_specific", "vc_mon.png"))
vc_m %>%
  #filter(!site %in% "Blind Oso") %>%
 ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  geom_point(
     aes(x = date,
        y = copies_mL,
        color = site))+
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Monthly Vibrio cholerae")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")
#dev.off()

 ggsave(here("results", "plots", "vc_monthly.png"))
```

#### Va

```{r}

va_m %>%
  #filter(!site %in% "Blind Oso") %>%
 ggplot() + geom_line(
    aes(x = date,
        y = copies_mL,
        color = site))+ 
  geom_point(
     aes(x = date,
        y = copies_mL,
        color = site))+
  facet_wrap(~site)  +
  labs(x = "Date",
       y = "Copies/mL",
       title = "Monthly Vibrio alginolyticus")+
  theme_bw()+
  theme(
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(hjust = 1, angle = 45),
    legend.position = "none")+
  scale_color_manual(values = c("Blind Oso" = "#809C52",
                                "Canals" = "#ba4716",
                                "Gulf" = "4c848c"))+
  scale_x_date(date_breaks = "1 month", date_labels = "%b")

 ggsave(here("results", "plots", "va_monthly.png"))
```
